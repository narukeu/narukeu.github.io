import{_ as i,c as a,o as n,ag as e}from"./chunks/framework.lo-SgHyK.js";const c=JSON.parse('{"title":"固定在 Hyper-V 中 Ubuntu Server 虚拟机的 IP 地址","description":"","frontmatter":{},"headers":[],"relativePath":"articles/ubuntu-server-hyperv-fix-ip.md","filePath":"articles/ubuntu-server-hyperv-fix-ip.md","lastUpdated":1770038376000}'),l={name:"articles/ubuntu-server-hyperv-fix-ip.md"};function p(t,s,h,k,r,d){return n(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="固定在-hyper-v-中-ubuntu-server-虚拟机的-ip-地址" tabindex="-1">固定在 Hyper-V 中 Ubuntu Server 虚拟机的 IP 地址 <a class="header-anchor" href="#固定在-hyper-v-中-ubuntu-server-虚拟机的-ip-地址" aria-label="Permalink to “固定在 Hyper-V 中 Ubuntu Server 虚拟机的 IP 地址”">​</a></h1><h2 id="_1-准备工作" tabindex="-1">1. 准备工作 <a class="header-anchor" href="#_1-准备工作" aria-label="Permalink to “1. 准备工作”">​</a></h2><p>Powershell 下输入 ipconfig，获取虚拟机所在网关（Default Switch）的信息，例如：</p><div class="language-plain"><button title="Copy Code" class="copy"></button><span class="lang">plain</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span>以太网适配器 vEthernet (Default Switch):</span></span>
<span class="line"><span></span></span>
<span class="line"><span>   连接特定的 DNS 后缀 . . . . . . . :</span></span>
<span class="line"><span>   本地链接 IPv6 地址. . . . . . . . : fe80::dfd0:f7f0:2421:b64e%27</span></span>
<span class="line"><span>   IPv4 地址 . . . . . . . . . . . . : 172.23.192.1</span></span>
<span class="line"><span>   子网掩码  . . . . . . . . . . . . : 255.255.240.0</span></span>
<span class="line"><span>   默认网关. . . . . . . . . . . . . :</span></span></code></pre></div><h2 id="_2-修改配置" tabindex="-1">2. 修改配置 <a class="header-anchor" href="#_2-修改配置" aria-label="Permalink to “2. 修改配置”">​</a></h2><p>Ubuntu Server 新版本用 netplan，因此需要修改 netplan 的配置文件，例如：</p><p>先通过 <code>sudo -s</code> 切换到 root，然后输入：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nano</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/netplan/50-cloud-init.yaml</span></span></code></pre></div><p>修改之前可以备份一下。</p><p>将内容修改为如下：</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">network</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  version</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  ethernets</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    eth0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      dhcp4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">no</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 使用虚拟机所在网段作为静态 IP 地址</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # / 后面是子网掩码位数，255.255.240.0 是 20</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">172.23.204.145/20</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      routes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">default</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          ## 使用虚拟机所在网关作为默认网关</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">          via</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">172.23.192.1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">      nameservers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">        addresses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">          # 用 Hyper-V 虚拟交换机的默认网关作为 DNS 服务器</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">          - </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">172.23.192.1</span></span></code></pre></div><p>然后输入：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netplan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> try</span></span></code></pre></div><p>确认没有问题后，输入：</p><div class="language-bash"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">netplan</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apply</span></span></code></pre></div>`,15)])])}const E=i(l,[["render",p]]);export{c as __pageData,E as default};
